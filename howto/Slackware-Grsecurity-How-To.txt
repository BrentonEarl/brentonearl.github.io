:keywords:    Linux, Security, Kernel, Grsecurity, PaX, Technology
:description: Exit Status One is a compilation of information about +
              Brenton Earl, his life, his projects, and how to get in +
              contact with him.  Brenton Earl is a free lance  +
              developer working with Linux, Ruby, and Python.


Slackware Linux: The Grsecurity Patch
--------------------------------------

This document is a work in progress.  It is mostly writen for my own record.
However, all corrections and suggestions are much appreciated.

The Grsecurity project maintains excellent documentation.  The goal of this
documentation is to fill the gaps between the official grsecurity
documentation and the lack of Slackware documentation regarding the grsecurity
patch.  It will contain links to grsecurity documentation and Slackware
documentation that can help you to fill the gap while patching your kernel and
configuring your system.

This documentation applies to Slackware x86_64 14.2 RC1, including all updates
up to Wed Apr  6 05:07:44 UTC 2016.  It assumes you have a full installation
of Slackware Linux.

This documentation from the Slackware Documentation Project discusses how to
compile a custom kernel in Slackware:

http://docs.slackware.com/slackbook:linux_kernel

Acquiring Kernel Source
------------------------
The kernel source should already be installed in /usr/src/.  In this case, it
is in /usr/src/linux (symbolic link) or in /usr/src/linux-4.4.6.  This source
code is ready to use as is with grsecurity.

It may be helpful to download the kernel source and kernel modules packages
from your mirror in the event that you require a quick reinstallation.  These
packages can also be found on your Slackware installation medium.

http://mirrors.slackware.com/slackware/


Obtaining the Grsecurity Patch
-------------------------------
There are three things you need to acquire.

1.  The grsecurity kernel patch

Refer to the grsecurity web site for the kernel patch that matches your kernel
source version.  Be aware that using the wrong patch number with an unmatched
kernel source tree is not recommened.  You will have negative results in most
cases.

Please also consider verifying your download with the available GPG signature.

https://grsecurity.net/download.php


Patching your Kernel
--------------------
Assuming that you saved the grsecurity patch to /usr/src, run:

cd /usr/src/linux
patch -p1 < ../grsecurity-3.1-4.4.6-201604021734.patch

Please note that the file name may differ from your patch file name.

.Configuring the Kernel Source
At the time of this writing, Slackware provided a 4.4.6 Linux kernel
configuration.  To configure your kernel, simply copy the provided
configuration file into /usr/src/linux.

Then you must run:

make menuconfig

Some text will flow down your terminal window and then a Curses screen will
apppear.  All of this is documented on the Slackware Documentation Project
page linked earlier.

The main goal at this point is to find and enable Grsecurity.  You will find
documentation discussing this topic futher here:

https://en.wikibooks.org/wiki/Grsecurity/Configuring_and_Installing_grsecurity#Configuring_the_Kernel


Build and Install your Patched  Kernel
--------------------------------------
In order to compile your kernel you must run the following:

cd /usr/src/linux
make bzImage && make modules

This is outlined and explained more thoroughly in the following link towards
the bottom of the page:

http://docs.slackware.com/slackbook:linux_kernel#compiling_a_kernel_and_why_to_do_so

Reboot your computer once you are finished making the necessary changes.  Key
points to remember:

1.  If you require it, build a initrd.
2.  Update your Lilo confugration file, and as root run

lilo -v

Obtaining the Grsecurity Administrative Utilities
--------------------------------------------------
There are a few things to do once you are booted into your newly created
grsecurity kernel.  There will be some configurations to do so that your
system is free of hiccups.  First though you need to download the following
software:

1.  The administrative tool, "gradm"
2.  The Pax user-space utility, "paxctl"

Both of these can be found on the https://slackbuilds.org web site.  If you
have sbopkg installed:

sbopkg -i "gradm paxctl"

Please install gradm and paxctl only after you have booted into your new
grsecurity patched kernel.  If you are uncertain that you are running the
correct kernel, just run as root:

uname -a


TO BE CONTINUED!
