<!DOCTYPE HTML>
<html lang="en">
	<head>       
		<meta charset=utf-8>
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
		<title>Exit Status One - Install Debian on Droid 2 Global A956</title>
		<meta name="author" content="Brent Earl" />
		
		<meta name="description" content="Learn to install Debian Linux on your Android." />
		
		
		<meta name="keywords" content="android" />
		
		<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
		<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">
		<link rel="stylesheet" herf="/css/styles.css" type="text/css">
		<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!--[if lt IE 9]>
		<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
		<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
		<![endif]-->
	</head>
	<body>
		<nav class="navbar navbar-inverse navbar-static-top" role="navigation">
			<div class="container">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<p class="navbar-brand" href="#">Menu</p>
				</div>
				<div class="navbar-collapse collapse">
					<ul class="nav navbar-nav">
						<li><a href="/" title=" Index">Home</a></li>
						
						
						
						<li><a href="/about.html" title="About the Author">About</a></li>
						
						
						
						<li><a href="/archive.html" title="Site Archives">Archives</a></li>
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						<li><a href="/rss.xml" title="RSS News Feed">News Feed</a></li>
						
						
						
						
					</ul>
				</div>
			</div>
		</nav>
		<header>
			<div class="container">
				<div class="page-header">
					<h1>Exit Status One <br /><small>The only source of knowledge is experience...</small></h1>
				</div>
			</div>
		</header>
	
		<div class="container">
					<div class="row">
				<div class="col-sm-8">
						<article>
						<h4>Install Debian on Droid 2 Global A956</h4>
						<p>
						06-22-2013 by <a href="https://twitter.com/BrentonLeeEarl">Brent Earl</a>
						</p>
						<p>
						Category <a href="/categories/android/">android</a>
						</p>
						<p>In this article I will walk through the process of bootstrapping Debian Linux with the armel architecture and “booting up” the image on an Android Operating System.  It works by telling the Android OS where the image is at and then executing the appropriate commands to attach to the image and chroot into a Bash shell as root.</p>

<p><strong><strong>Important:  You must have significant knowledge on how to use Linux, program in Bash, and a good understanding of how your Android device functions in order to complete this tutorial.  I am not responsible if you “brick” your phone.</strong></strong></p>

<p>Phone Specifications:</p>

<ul>
<li>System Version: 4.5.629.A956.Verizon.en.US</li>
<li>Model Number: Droid2 Global</li>
<li>Android Version: 2.3.4</li>
<li>Kernel Version: 2.6.32.9</li>
</ul>


<p>Prerequisites:</p>

<ul>
<li>Your Phone Must be rooted</li>
<li>You must have Busybox installed on your phone</li>
<li>You must have a terminal emulator installed on your phone</li>
</ul>


<p>Additionally, it is recommended that you complete this tutorial from a Debian installed laptop or desktop for simplicity.  I installed Debian on my phone using a Debian Wheezy install on my laptop.  Knowledge of Bash Scripting is recommended.</p>

<p><strong>Video tutorial below, or scroll down to continue reading.</strong></p>

<p id="video">
    <object width="560" height="315"><param name="movie" value="//www.youtube.com/v/Xz28zf5ky14?version=3&amp;hl=en_US"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="//www.youtube.com/v/Xz28zf5ky14?version=3&amp;hl=en_US" type="application/x-shockwave-flash" width="560" height="315" allowscriptaccess="always" allowfullscreen="true"></embed></object>
</p>


<p>The first step is to build a 2GB Debian image which we will later on use to boot Debian on your Android phone.  After that you will need to prepare a boot script to boot into Debian on your phone.  Next you will need to install the Android SDK so you can access your phone from a laptop in Linux.  Finally you will execute the boot script for Debian and enter the chroot environment, finish installing the Debian base system, update your repository information for apt, and update your system.</p>

<p><strong>Step 1: Create a Debian Image</strong></p>

<p>Creating the image file</p>

<ol>
<li>Log onto your Debian installed Laptop/Desktop, open a terminal and log in as root</li>
<li>Run: “apt-get install debootstrap”</li>
<li><p>Create the 2GB Debian image by running</p></li>
<li><p>dd if=/dev/zero of=debian.img bs=1024 count=2M</p></li>
</ol>


<p>Next, create an ext3 file system within the debian.img file you just created:</p>

<ul>
<li>mkfs -t ext3 -F debian.img</li>
</ul>


<p>Next we will debootstrap a base system into debian.img by executing the following:</p>

<ol>
<li>cd /root</li>
<li>mkdir debian/</li>
<li>mount -o loop debian.img debian/</li>
<li>debootstrap –verbose –arch armel –foreign wheezy debian http://ftp.us.debian.org/debian</li>
<li>unmount debian/</li>
<li>rm -r debian/</li>
</ol>


<p>Now debian.img is ready for a first boot.  On to the next step.</p>

<p><strong>Step 2: Creating the boot script</strong></p>

<p>I named my Debian boot script “bootdebian”.  You can name it whatever you like, just remember the name because it will be the command you execute as “su” on your Android once everything is in place.</p>

<div class="highlight"><pre><code class="bash"><span class="c">#!/bin/bash</span>

<span class="nb">echo</span> “<span class="o">=========================</span>”
<span class="nb">echo</span> “<span class="o">=========================</span>”
<span class="nb">echo</span> ” Booting Debian”
<span class="nb">echo</span> “<span class="o">=========================</span>”
<span class="nb">echo</span> “<span class="o">=========================</span>”

<span class="nb">echo</span> “Mounting Droid Internal Drive as Read/Write”
mount -o remount,rw -t yaffs2 /dev/block/mmcblk1p21 /system
<span class="nb">echo</span> <span class="p">;</span> sleep 1
<span class="nb">echo</span> “Droid Internal Drive Mounted at”
mount <span class="p">|</span> grep /system
<span class="nb">echo</span> <span class="p">;</span> sleep 1
<span class="nb">echo</span> “Setting Environmental Variables”
<span class="nb">export </span><span class="nv">bin</span><span class="o">=</span>/system/bin
<span class="nb">export </span><span class="nv">img</span><span class="o">=</span>/mnt/sdcard/debian.img
<span class="nb">export </span><span class="nv">mnt</span><span class="o">=</span>/data/local/debian
<span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$bin</span>:/usr/bin:/usr/sbin:/bin:<span class="nv">$PATH</span>
<span class="nb">export </span><span class="nv">TERM</span><span class="o">=</span>linux
<span class="nb">export </span><span class="nv">HOME</span><span class="o">=</span>/root
<span class="nb">echo</span> <span class="p">;</span>sleep 1

<span class="nb">echo</span> “Verifying /data/local/debian exists.”
<span class="nb">echo</span> <span class="p">;</span>sleep 1
<span class="k">if</span> <span class="o">[</span> ! -d <span class="nv">$mnt</span> <span class="o">]</span>
<span class="k">then</span>
<span class="nb">echo</span> “Creating /data/local/debian.”
mkdir <span class="nv">$mnt</span>
<span class="k">fi</span>
<span class="nb">echo</span> <span class="p">;</span>sleep 1

<span class="nb">echo</span> “Mounting the Linux Image”
<span class="k">if</span> <span class="o">[</span> -b <span class="s2">&quot;/dev/block/loop99&quot;</span> <span class="o">]</span>
<span class="k">then</span>
<span class="nb">echo</span> “Loop device exists, removing loop99″
losetup -d /dev/block/loop99
<span class="nb">echo</span> <span class="p">;</span>sleep 1
<span class="k">fi</span>
<span class="nb">echo</span>
<span class="nb">echo</span> “Running mknod /dev/block/loop99 b 7 99″
mknod /dev/block/loop99 b 7 99
<span class="nb">echo</span> <span class="p">;</span> sleep 1

<span class="nb">echo</span> “Running losetup /dev/block/loop99 /mnt/sdcard/debian.img”
losetup /dev/block/loop99 <span class="nv">$img</span>
<span class="nb">echo</span> <span class="p">;</span> sleep 1

<span class="nb">echo</span> “Mounting loop99″
mount -t ext3 -o noatime,nodiratime /dev/block/loop99 <span class="nv">$mnt</span>

<span class="nb">echo</span> “Mounting devpts”
mount -t devpts devpts <span class="nv">$mnt</span>/dev/pts

<span class="nb">echo</span> “Mounting proc”
mount -t proc proc <span class="nv">$mnt</span>/proc

<span class="nb">echo</span> “Mounting sysfs”
mount -t sysfs sysfs <span class="nv">$mnt</span>/sys
<span class="nb">echo</span> <span class="p">;</span> sleep 1

<span class="nb">echo</span> “Setting Up Networking”
sysctl -w net.ipv4.ip_forward<span class="o">=</span>1
<span class="nb">echo</span> <span class="p">;</span> sleep 1

<span class="nb">echo</span> “Adding Nameserver 8.8.8.8 and 8.8.4.4″
<span class="nb">echo</span> “nameserver 8.8.8.8″ &gt; <span class="nv">$mnt</span>/etc/resolv.conf<span class="p">;</span>
<span class="nb">echo</span> “nameserver 8.8.4.4″ &gt;&gt; <span class="nv">$mnt</span>/etc/resolv.conf
<span class="nb">echo</span> “Adding 127.0.0.1 localhost to hosts file”
<span class="nb">echo</span> “127.0.0.1 localhost” &gt; <span class="nv">$mnt</span>/etc/hosts
<span class="nb">echo</span> <span class="p">;</span> sleep 1

<span class="nb">echo</span> “Mounting sdcard in /mnt”
<span class="k">if</span> <span class="o">[</span> ! -d <span class="nv">$mnt</span>/mnt/sdcard <span class="o">]</span>
<span class="k">then</span>
mkdir <span class="nv">$mnt</span>/mnt/sdcard
<span class="k">fi</span>
busybox mount –bind /mnt/sdcard/ <span class="nv">$mnt</span>/mnt/sdcard

<span class="nb">echo</span> “Executing chroot <span class="k">for </span>Debian System”
<span class="nb">echo</span>
chroot <span class="nv">$mnt</span> /bin/bash

<span class="nb">echo</span>
<span class="nb">echo</span> “Shutting Down Debian”
<span class="nb">echo</span> <span class="p">;</span> sleep 1
<span class="nb">echo</span> “Unmounting sdcard”
umount <span class="nv">$mnt</span>/mnt/sdcard
<span class="nb">echo</span> “Restoring ipv4″
sysctl -w net.ipv4.ip_forward<span class="o">=</span>0
<span class="nb">echo</span> “Unmounting pts”
umount <span class="nv">$mnt</span>/dev/pts
<span class="nb">echo</span> “Unmounting proc”
umount <span class="nv">$mnt</span>/proc
<span class="nb">echo</span> “Unmounting sys”
umount <span class="nv">$mnt</span>/sys
<span class="nb">echo</span> “Unmounting /data/local/debian”
umount <span class="nv">$mnt</span>
<span class="nb">echo</span> “Removing /dev/block/loop99″
losetup -d /dev/block/loop99
<span class="nb">echo</span> “Remounting /system Read Only”
mount -o remount,ro -t yaffs2 /dev/block/mmcblk1p21 /system
</code></pre></div>


<p>What this script does:</p>

<ol>
<li>Mounts your internal android storage device as read / write</li>
<li>Creates directory “/data/local/debian” on your android device</li>
<li>Creates block device /dev/block/loop99 and mounts it as a ext3 file system</li>
<li>Mounts proc, sysfs, devpts</li>
<li>Sets up IPV4 forwarding, sets the name servers, and creates the hosts file</li>
<li>Mounts the sdcard</li>
<li>Executes the chroot</li>
<li>Once you are finished doing whatever it is you do in Debian, hit exit at the shell prompt and then the script will continue to run</li>
<li>The final portion of the script unmounts file systems used by debian.img, removed /dev/block/loop99 and remounts your android internal disk as read only</li>
</ol>


<p>What you will need to modify so that the script will run on YOUR android phone:</p>

<ol>
<li>First off find out where your internal file system is mounted at by running: “mount | grep /system”  in your busybox terminal emulator</li>
<li>Second edit the bootdebian script so that it will remount the internal disk as read / write at the beginning of the script and read only at the end of the script</li>
<li>Now, /bin/bash does not exist within the busybox installation on your android device</li>
<li>You will need to create a symlink from /system/bin/sh to /bin/bash.  You will need to create the /bin directory prior to creating the symlink.  You will need to mount the root files system on your android device with write priviledges:  mount -wo remount rootfs /</li>
<li>Once you have created the symlink, the boot script will be able to execute a bash shell (sh) upon executing the chroot command to enter the debian install</li>
</ol>


<p>At this point you might be thinking:  ”Great, I have the Debian image created and a boot script to boot up Debian.  How do I get these two files onto my android phone in order to boot up my new OS?”</p>

<p><strong>Step 3:  Install the Android SDK, boot script, and debian.img</strong></p>

<p>In this step I will walk you through installing the Android SDK on your Debian Linux Laptop or Desktop.</p>

<ol>
<li>Download the Android SDK (ADT Bundle for Linux) from:  http://developer.android.com/sdk/index.html</li>
<li>Create a directory in your home folder, I used /home/user/Projects, then extract the SDK into that directory</li>
<li>Change to the adt-bundle-linux-xx-xxxxx directory where xx is your platform and xxxxx is the version of your adt bundle directory.  Then change directory to sdk/platform-tools</li>
<li>Assure your Android phone is connected to your USB port and that the USB connection on your phone is set to “Charge Only”</li>
<li>Execute: sudo ./adb devices</li>
<li>You should see that your device is recognized</li>
<li>Next execute sudo ./adb shell</li>
<li>If you received a shell prompt with a “$” you are logged on to your android device,  type “exit”.</li>
<li>Next we will be pushing files onto your phone using the adb program.</li>
<li> To upload the boot script, Execute:  sudo ./adb push /local/path/to/bootdebian /sdcard/bootdebian</li>
<li> To upload the debian.img file, Execute:  sudo ./adb push /local/path/to/debian.img /sdcard/debian.img</li>
<li> Next execute:  sudo ./adb shell</li>
<li> Type: “mount | grep /system”  and make note of what /dev/block file your internal hard disk is mounted to</li>
<li><p> Then, Execute the following commands while replacing /dev/block/mmcblk1p21 with the appropriate /dev/block file on your device:</p></li>
<li><p>mount -o remount,rw -t yaffs2 /dev/block/mmcblk1p21 /system</p></li>
<li>mount -wo remount rootfs /</li>
<li>cp /sdcard/bootdebian /system/xbin/bootdebian</li>
<li>chmod 777 /system/xbin/bootdebian</li>
<li>mount -ro remount rootfs /</li>
<li>exit</li>
</ol>


<p>Phew, all files are now copied and ready to be ran!</p>

<p><strong>Step 4: Finishing up</strong></p>

<p>In this portion of the guide you will be executing your boot script (bootdebian) for the first time.  Once you are in the chroot environment you will need to finish up the Debian installation.</p>

<p>This step can either be done directly on your phone, or by using the adb command on your laptop.  I chose to do it from my laptop.</p>

<p>Execute from the android sdk platform-tools directory:
- sudo ./adb shell</p>

<p>Run boot script on your Android phone:
- bootdebian</p>

<p>Once the script has ran you should see the Debian command prompt:</p>

<ul>
<li>root@localhost:/#</li>
</ul>


<p>Next portion is installing the rest of the Debian Wheezy base system.  You will have all the essential programs required to run a very basic Linux installation.  Once you have completed your installation you can then start searching for software in the Debian repositories to install on your device.</p>

<ol>
<li>Run:  /debootstrap/debootstrap –second-stage</li>
<li>This will take a bit to run, since it is using your Android’s hardware.  Took me about 5 minutes</li>
<li>Run:  echo ‘deb http://ftp.us.debian.org/debian wheezy main’ > /etc/apt/sources.list</li>
<li>Clean up your system with:  apt-get autoclean</li>
<li>Update your package list:  apt-get update</li>
<li>At this point you can start customizing your installation by setting the hostname, creating user accounts, securing the system… etc. etc. etc.</li>
</ol>


<p><strong>Toubleshooting your first log in</strong></p>

<p>If you see at your command prompt:</p>

<ul>
<li>I have no name!@localhost:/#</li>
</ul>


<p>You will need to make sure the permissions for /etc/passwd are 644:</p>

<ul>
<li>chmod 644 /etc/passwd</li>
</ul>


<p>After you reboot into your debian installation using the bootdebian script, this issue should be fixed.</p>

<p>Credit should be given to MRLANRAT @ lanrat.com.  His guide (http://lanrat.com/install-debian-on-android/) was a big help.  I had to modify a lot of the information in his tutorial because it is out dated.  I also had to rewrite the bootdebian boot script because it did not work on my Droid 2 Global.  However, he should be credited all the same.</p>

					</article>
				</div>
				<div class="col-sm-4">
					<div class="list-group">
						<h4 class="list-group-item">Related Posts</h4>
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						<a class="list-group-item" href="/useful-android-apps/" title="Useful, Free Android Apps">Useful, Free Android Apps</a>
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						<a class="list-group-item" href="/android-system-vulnerabilities/" title="Android Operating System Vulnerabilities">Android Operating System Vulnerabilities</a>
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						<a class="list-group-item" href="/jailbreak-droid-2-global/" title="How to Jailbreak Droid 2 Global">How to Jailbreak Droid 2 Global</a>
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
					</div>
				</div>
			</div>

<div class="row">
	<div class="col-sm-8">
		<div id="disqus_thread" style="padding:1%;"></div>
		<script type="text/javascript">
		var disqus_shortname = 'exitstatusone';
		(function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
		})();
		</script>
		<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
		<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
	</div>
</div>



		</div>
	
		<footer>
			<div class="container">
				<div class="row">
					<div class="col-sm-8">
						<p class="footer">
						Designed by Brent Earl | &copy; 2014 Exit Status One. All Rights Reserved.
						</p>
					</div>
				</div>
			</div>
		</footer>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
		<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
	</body>
</html>
