<!DOCTYPE HTML>
<!-- Microdata markup added by Google Structured Data Markup Helper. -->
<html lang="en">
	<head>       
		<meta charset=utf-8>
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
		<title>Exit Status One - The Fuzz</title>
		<meta name="author" content="Brenton Earl" />
		
		<meta name="description" content="Fuzzing is the automated process of testing software using random input or input that would not otherwise be sent to a program in order to discover design errors." />
		
		
		<meta name="keywords" content="security" />
		
		<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
		<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">
		<link rel="stylesheet" herf="/css/styles.css" type="text/css">
		<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!--[if lt IE 9]>
		<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
		<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
		<![endif]-->
	</head>
	<body>
		<nav class="navbar navbar-inverse navbar-static-top" role="navigation">
			<div class="container">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<p class="navbar-brand" href="#">Menu</p>
				</div>
				<div class="navbar-collapse collapse">
					<ul class="nav navbar-nav">
						<li><a href="/" title=" Index">Home</a></li>
						
						
						
						<li><a href="/about.html" title="About the Author">About</a></li>
						
						
						
						<li><a href="/archive.html" title="Site Archives">Archives</a></li>
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						
						<li><a href="/rss.xml" title="RSS News Feed">News Feed</a></li>
						
						
						
						
					</ul>
				</div>
			</div>
		</nav>
		<header>
			<div class="container">
				<div class="page-header">
					<h1>Exit Status One</h1>
					<small>while : ; do echo 'Tinker, explore, hack, learn...' ; sleep 28800 ; clear ; done</small>
				</div>
			</div>
		</header>
	
		<div class="container">
					<div class="row">
				<div class="col-sm-8">
					<article itemscope itemtype="http://schema.org/Article">
						<h4 itemprop="name">The Fuzz</h4>
						<p>
							<span itemprop="datePublished" content="12-13-2013">							
								12-13-2013
							</span>
							 by 
							<a href="https://plus.google.com/+Exitstatusone" rel="publisher">
								<span itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
									<span itemprop="name">Brenton Earl</span>
								</span>
							</a>
						</p>
						

						<p>
						Category <a href="/categories/security/">security</a>
						</p>
						<span itemprop="articleBody">
							<p>Fuzz testing is the process of sending random or semi random data as input to a piece of software, network protocol, or file format in order to discover design flaws.  The process is generally automated but can be semi-automated to give the auditor the ability to modify input to achieve faster results.  There are two forms of fuzzing, mutation based and generation based, and it can be utilized by means of white-box, grey-box or black-box testing.  Today I will be talking about grey-box testing using a generation-based fuzzer on a network based application.</p>

<p>The network based application I chose to test was the game Urban Terror.  My reasoning in choosing to test this particular software was that I have access to partial <a href="https://github.com/Barbatos/ioq3-for-UrbanTerror-4">source code</a> and I also have the ability to set up a gaming server.  This game is not 100% open source.  There is a portion of the code that is closed source that has not been released by the Frozen Sand Development team.  (Particularly the game server virtual machine code.)</p>

<p>Now, I have never done anything like this before so I had to do quite a bit of research.  Here is a list of the software I used in my testing:</p>

<ul>
<li><a href="https://www.gnu.org/software/gdb/">GDB</a></li>
<li><a href="http://valgrind.org/">Valgrind</a></li>
<li><a href="http://caca.zoy.org/wiki/zzuf">zzuf</a></li>
<li><a href="http://netcat.sourceforge.net/">netcat</a></li>
<li><a href="http://www.gnu.org/software/bash/">Good Old Bash</a></li>
</ul>


<p>The approach I took was quite simple.  My aim was to create an environment where the server binary ran in gdb.  I would then send data that zzuf created to the server using netcat.  If something went badly I would restart the server in Valgrind. I would then recreate the issue while the server binary ran in Valgrind so that I could determine exactly what failed.</p>

<p>Interestingly enough, I found that the game server can be crashed just by sending data to it.  In addition, the way the Quake 3 network protocol is designed, it is susceptible to very simple Denial of Service attacks.  My experiment started off with a simple bash script that later grew into something larger.  Replacing the fuzz variable with your input source can yield many different results.  Here is what I started out with:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c">#!/bin/bash</span>
 
<span class="nv">host</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span>
<span class="nv">port</span><span class="o">=</span><span class="s2">&quot;27960&quot;</span>
<span class="nv">nc</span><span class="o">=</span><span class="s2">&quot;$(which nc)&quot;</span>
<span class="nv">pass</span><span class="o">=</span><span class="s2">&quot;cat&quot;</span>
<span class="nv">timeout</span><span class="o">=</span><span class="s2">&quot;3&quot;</span>
<span class="nv">fuzz</span><span class="o">=</span><span class="sb">`</span>dd <span class="k">if</span><span class="o">=</span>/dev/urandom <span class="nv">bs</span><span class="o">=</span>1K <span class="nv">count</span><span class="o">=</span>1b<span class="sb">`</span>

<span class="k">while</span> :<span class="p">;</span> <span class="k">do</span>
    <span class="nb">echo</span> -e <span class="s2">&quot;\xff\xff\xff\xffrcon $pass $fuzz&quot;</span> <span class="p">|</span> <span class="nv">$nc</span> -q <span class="nv">$timeout</span> -u <span class="nv">$host</span> <span class="nv">$port</span>
<span class="k">done</span></code></pre></div>


<p>Being that I play this game, I will not be releasing specific results due to the fact that I do not want to be banned from every remaining Urban Terror server on the internet.  I do enjoy the game and do not wish any ill-will on Urban Terror server administrators or the game developers.  It should be interesting how long it takes for the game developers to patch up some of these security holes.  Until then...</p>

<p>General security measures to circumvent my results:</p>

<p>Above all, I recommend that Urban Terror server administrators run their game server binaries in a jailed environment.  I also suggest that administrators devise an iptables script that filters out packet types that should never be received by their server.  This also includes fragmented packets.  Brute Force attacks are possible over a Rcon connection to an Urban Terror server, so be sure to use strong passwords.  Finally, administrators should also be sure to implement some type of Quality of Service, or general bandwidth throttling on the network interface running Urban Terror.</p>

<h4>Linux Security Implementation Resources</h4>

<ul>
<li>Jail/Chroot Environment - <a href="http://www.floc.net/makejail/">makejail</a></li>
<li>Firewall - <a href="http://exitstatusone.com/assets/firewall.sh.txt">Starter Iptables Script</a></li>
<li>Brute Force Attack - <a href="/block-port-scan-brute-force/">Psad, Fail2Ban, AGP</a></li>
<li>Routing and Traffic Countrol - <a href="http://lartc.org/">Linux Advanced Routing &amp; Traffic Control</a></li>
</ul>


						</span>
					</article>
				</div>
				<div class="col-sm-4">
				<div class="list-group">
	<h4 class="list-group-item">Related Posts</h4>
	
		
			
				
					<a class="list-group-item" href="/ruby-and-nmap/" title="Ruby and Nmap">Ruby and Nmap</a>
				
			
		
	
		
			
				
			
		
	
		
			
		
	
		
			
				
					<a class="list-group-item" href="/block-port-scan-brute-force/" title="Block Port Scans and Brute Force Attacks">Block Port Scans and Brute Force Attacks</a>
				
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
				
					<a class="list-group-item" href="/medusa-log-in-auditor/" title="Medusa - Parallel Network Login Auditor">Medusa - Parallel Network Login Auditor</a>
				
			
		
	
		
			
				
					<a class="list-group-item" href="/crunch-word-list-generator/" title="Crunch Word List Generator">Crunch Word List Generator</a>
				
			
		
	
		
			
		
	
		
			
		
	
		
			
				
					<a class="list-group-item" href="/anonymity/" title="Anonymity">Anonymity</a>
				
			
		
	
		
			
		
	
		
			
		
	
		
			
				
					<a class="list-group-item" href="/proxy-chains-anonymous-web-browsing/" title="Proxy Chains – Anonymous Web Browsing">Proxy Chains – Anonymous Web Browsing</a>
				
			
		
	
		
			
		
	
		
			
		
	
		
			
				
					<a class="list-group-item" href="/penetration-testing-nessus-metasploit/" title="Penetration Testing with Metasploit 4 and Nessus 5.2">Penetration Testing with Metasploit 4 and Nessus 5.2</a>
				
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
</div>


				</div>
			</div>
			<br /><br />
<p><strong>If you feel the information here is outdated or incorrect, you can submit a <a href="https://github.com/BrentonEarl/brentonearl.github.io/edit/source/_posts/2013-12-13-the-fuzz.markdown">Pull Request on Github!</a></strong></p>

			
<div class="row">
	<div class="col-sm-8">
		<div id="disqus_thread" style="padding:1%;"></div>
		<script type="text/javascript">
		var disqus_shortname = 'exitstatusone';
		(function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
		})();
		</script>
		<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
		<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
	</div>
</div>



		</div>
	
		<footer>
			<div class="container">
				<div class="row">
					<div class="col-sm-8">
						<p class="footer">
						&copy; 2015 Brenton Earl. Powered by <a href="http://jekyllrb.com/" title="Jekyllrb">Jekyll</a>.
						</p>
					</div>
				</div>
			</div>
		</footer>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
		<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
	</body>
</html>
